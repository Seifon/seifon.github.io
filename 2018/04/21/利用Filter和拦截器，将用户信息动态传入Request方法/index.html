<!DOCTYPE HTML>
<html lang="zh-CN">
<head>
    <!--Setting-->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta name="apple-mobile-web-app-capable" content="熊峰的博客 - Seifon&#39;s Blog">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no,email=no,adress=no">
    <meta name="browsermode" content="application">
    <meta name="screen-orientation" content="portrait">
    <link rel="dns-prefetch" href="http://www.seifon.cn">
    <!--SEO-->

    <meta name="keywords" content="拦截器,Filter," />


    <meta name="description" content="前言：
在开发当中，经常会验证用户登录状态和获取用户信息。如果每次都手动调用用户信息查询接口，会非常的繁琐，而且代码冗余。为了提高开发效率，因此就有了今天这篇文章。

思路：
用户请求我们的方法会携带一个Token，通过Filter过滤器将会员信息查出来并放到request请求参数中。接着在C..." />


<meta name="robots" content="all" />
<meta name="google" content="all" />
<meta name="googlebot" content="all" />
<meta name="verify" content="all" />
    <!--Title-->


<title>利用Filter和Spring拦截器，将用户信息动态传入Request方法 | 熊峰的博客 - Seifon&#39;s Blog</title>


    <link rel="alternate" href="/atom.xml" title="熊峰的博客 - Seifon&#39;s Blog" type="application/atom+xml">


    <link rel="icon" href="/favicon.ico">

    



<link rel="stylesheet" href="/css/bootstrap.min.css?rev=3.3.7">
<link rel="stylesheet" href="/css/font-awesome.min.css?rev=4.5.0">
<link rel="stylesheet" href="/css/style.css?rev=@@hash">




    



    <script>
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?0a12e606ddb1f91f0a67ccb060b3c2eb";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>



    
</head>


<!--[if lte IE 8]>
<style>
    html{ font-size: 1em }
</style>
<![endif]-->
<!--[if lte IE 9]>
<div style="ie">你使用的浏览器版本过低，为了你更好的阅读体验，请更新浏览器的版本或者使用其他现代浏览器，比如Chrome、Firefox、Safari等。</div>
<![endif]-->

<body>
    
    <nav class="main-navigation">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="navbar-header"><span class="nav-toggle-button collapsed" data-toggle="collapse" data-target="#main-menu" id="mnav">
                    <span class="sr-only"></span>
                        <i class="fa fa-bars"></i>
                    </span>
                </div>
                <div class="collapse navbar-collapse" id="main-menu">
                    <ul class="menu">
                        
                            <li role="presentation" class="text-center">
                                <a href="/"><i class="fa fa-home"></i>熊峰的博客</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories"><i class="fa fa-list"></i>分类</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/archives"><i class="fa fa-archive"></i>归档</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/tags"><i class="fa fa-tag"></i>标签</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/about"><i class="fa fa-user"></i>关于</a>
                            </li>
                        
                    </ul>
                </div>
            </div>
        </div>
    </div>
</nav>

<a href="http://github.com/seifon">
    <img style="position: absolute; top: 0; right: 0; border: 0;"
        src="/img/forkme.png"
        alt="Fork me on GitHub">
</a>

    <section class="content-wrap">
        <div class="container">
            <div class="row">
                <main class="col-md-8 main-content m-post">
                    <p id="process"></p>
<article class="post">
    <div class="post-head">
        <h1 id="利用Filter和Spring拦截器，将用户信息动态传入Request方法">
            
	            利用Filter和Spring拦截器，将用户信息动态传入Request方法
            
        </h1>
        <div class="post-meta">
    
    
    <span class="categories-meta fa-wrap">
        <i class="fa fa-folder-open-o"></i>
        <a href="/categories/Spring">
            Spring
        </a>
    </span>
    
    
    <span class="fa-wrap">
        <i class="fa fa-tags"></i>
        <span class="tags-meta">
            
                
                    <a href="/tags/拦截器" title='拦截器'>
                        拦截器
                    </a>
                
                    <a href="/tags/Filter" title='Filter'>
                        Filter
                    </a>
                
            
        </span>
    </span>
    

    
        
        <span class="fa-wrap">
            <i class="fa fa-clock-o"></i>
            <span class="date-meta">2018/04/21</span>
        </span>
    
</div>

            
            
    </div>
    
    <div class="post-body post-content">
        <h4 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h4><ul>
<li>在开发当中，经常会验证用户登录状态和获取用户信息。如果每次都手动调用用户信息查询接口，会非常的繁琐，而且代码冗余。为了提高开发效率，因此就有了今天这篇文章。</li>
</ul>
<h4 id="思路："><a href="#思路：" class="headerlink" title="思路："></a>思路：</h4><ul>
<li>用户请求我们的方法会携带一个Token，通过Filter过滤器将会员信息查出来并放到request请求参数中。接着在Cotroller层的请求方法中接收一个MemberDeatails类型的参数，就能直接获得会员信息了。</li>
</ul>
<h4 id="详细步骤："><a href="#详细步骤：" class="headerlink" title="详细步骤："></a>详细步骤：</h4><h5 id="1-Gradle引入需要的Jar包："><a href="#1-Gradle引入需要的Jar包：" class="headerlink" title="1. Gradle引入需要的Jar包："></a>1. Gradle引入需要的Jar包：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">compile &quot;com.fasterxml.jackson.core:jackson-databind:2.8.10&quot;</span><br></pre></td></tr></table></figure>
<h5 id="2-定义一个Login注解"><a href="#2-定义一个Login注解" class="headerlink" title="2. 定义一个Login注解"></a>2. 定义一个Login注解</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@Target(&#123;ElementType.METHOD&#125;)</span><br><span class="line">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="line">@Documented</span><br><span class="line">public @interface Login &#123;</span><br><span class="line"></span><br><span class="line">    String value() default &quot;&quot;;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="3-定义一个MemberDetails-class，用于封装用户信息"><a href="#3-定义一个MemberDetails-class，用于封装用户信息" class="headerlink" title="3. 定义一个MemberDetails.class，用于封装用户信息"></a>3. 定义一个MemberDetails.class，用于封装用户信息</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MemberDetails</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String memberId;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String memberName;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String memberNickname;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String memberPhone;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String memberEmail;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="5-定义一个会员接口类"><a href="#5-定义一个会员接口类" class="headerlink" title="5. 定义一个会员接口类"></a>5. 定义一个会员接口类</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: XiongFeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: 会员接口</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span>: Created in 19:40 2018/4/10</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">MemberService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/** 根据TokenId获取用户信息 */</span></span><br><span class="line">    <span class="function">MemberDto <span class="title">getMemberByToken</span><span class="params">(String token)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="6-定义一个会员接口实现类，在里面写上用户信息获取方法"><a href="#6-定义一个会员接口实现类，在里面写上用户信息获取方法" class="headerlink" title="6. 定义一个会员接口实现类，在里面写上用户信息获取方法"></a>6. 定义一个会员接口实现类，在里面写上用户信息获取方法</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">@Service</span><br><span class="line">public class MemberServiceImpl implements MemberService &#123;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public MemberDetails getMemberDetailsByToken(String token) &#123;</span><br><span class="line">        if (StringUtils.isBlank(token)) return null;</span><br><span class="line">        if (!&quot;123&quot;.equals(token)) return null;</span><br><span class="line">        MemberDetails memberDetails = new MemberDetails();</span><br><span class="line">        memberDetails.setMemberId(&quot;123&quot;);</span><br><span class="line">        memberDetails.setMemberName(&quot;哈哈123&quot;);</span><br><span class="line">        memberDetails.setMemberEmail(&quot;seifon@seifon.cn&quot;);</span><br><span class="line">        memberDetails.setMemberNickname(&quot;Seifon&quot;);</span><br><span class="line">        memberDetails.setMemberPhone(&quot;13100001111&quot;);</span><br><span class="line">        return memberDetails;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="7-定义一个Request请求包装类"><a href="#7-定义一个Request请求包装类" class="headerlink" title="7. 定义一个Request请求包装类"></a>7. 定义一个Request请求包装类</h5><ul>
<li>通过继承HttpServletRequestWrapper类，重写它里面的多个方法，对前端传过来的参数进行重新封装。因为在Filter，虽然可以通过request.getParameterMap()拿到一个含有参数的map，但是不能直接对request里面东西进行修改操作，一旦重新修改，就会报错。后来我发现j2ee已经给我们提供了解决的办法，使用HttpServletRequestWrapper类来解决向request添加额外参数的功能。于是我对HttpServletRequest进行重新包装，在里面重新定义一个map，将以前的参数put进去，并将我们需要添加的参数放进去，达到我们想要的效果。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><span class="line">import javax.servlet.http.HttpServletRequest;</span><br><span class="line">import javax.servlet.http.HttpServletRequestWrapper;</span><br><span class="line">import java.util.Enumeration;</span><br><span class="line">import java.util.HashMap;</span><br><span class="line">import java.util.Map;</span><br><span class="line">import java.util.Vector;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @Author: XiongFeng</span><br><span class="line"> * @Description: 对Request请求重新包装</span><br><span class="line"> * @Date: Created in 11:17 2018/4/13</span><br><span class="line"> */</span><br><span class="line">public class ParameterRequestWrapper extends HttpServletRequestWrapper &#123;</span><br><span class="line"></span><br><span class="line">    private Map&lt;String , String[]&gt; params = new HashMap&lt;String, String[]&gt;();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    @SuppressWarnings(&quot;unchecked&quot;)</span><br><span class="line">    public ParameterRequestWrapper(HttpServletRequest request) &#123;</span><br><span class="line">        // 将request交给父类，以便于调用对应方法的时候，将其输出，其实父亲类的实现方式和第一种new的方式类似</span><br><span class="line">        super(request);</span><br><span class="line">        //将参数表，赋予给当前的Map以便于持有request中的参数</span><br><span class="line">        this.params.putAll(request.getParameterMap());</span><br><span class="line">    &#125;</span><br><span class="line">    //重载一个构造方法</span><br><span class="line">    public ParameterRequestWrapper(HttpServletRequest request , Map&lt;String , Object&gt; extendParams) &#123;</span><br><span class="line">        this(request);</span><br><span class="line">        addAllParameters(extendParams);//这里将扩展参数写入参数表</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 复写获取key的方法</span><br><span class="line">     */</span><br><span class="line">    @Override</span><br><span class="line">    public Enumeration getParameterNames() &#123;</span><br><span class="line">        Vector names = new Vector(params.keySet());</span><br><span class="line">        return names.elements();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 复写获取值value的方法</span><br><span class="line">     */</span><br><span class="line">    @Override</span><br><span class="line">    public String getParameter(String name) &#123;</span><br><span class="line">        Object v = params.get(name);</span><br><span class="line">        if (v == null) &#123;</span><br><span class="line">            return null;</span><br><span class="line">        &#125; else if (v instanceof String[]) &#123;</span><br><span class="line">            String[] strArr = (String[]) v;</span><br><span class="line">            if (strArr.length &gt; 0) &#123;</span><br><span class="line">                return strArr[0];</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                return null;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; else if (v instanceof String) &#123;</span><br><span class="line">            return (String) v;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            return v.toString();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String[] getParameterValues(String name) &#123;</span><br><span class="line">        Object v = params.get(name);</span><br><span class="line">        if (v == null) &#123;</span><br><span class="line">            return null;</span><br><span class="line">        &#125; else if (v instanceof String[]) &#123;</span><br><span class="line">            return (String[]) v;</span><br><span class="line">        &#125; else if (v instanceof String) &#123;</span><br><span class="line">            return new String[] &#123; (String) v &#125;;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            return new String[] &#123; v.toString() &#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void addAllParameters(Map&lt;String , Object&gt;otherParams) &#123;//增加多个参数</span><br><span class="line">        for(Map.Entry&lt;String , Object&gt;entry : otherParams.entrySet()) &#123;</span><br><span class="line">            addParameter(entry.getKey() , entry.getValue());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    public void addParameter(String name , Object value) &#123;//增加参数</span><br><span class="line">        if(value != null) &#123;</span><br><span class="line">            if(value instanceof String[]) &#123;</span><br><span class="line">                params.put(name , (String[])value);</span><br><span class="line">            &#125;else if(value instanceof String) &#123;</span><br><span class="line">                params.put(name , new String[] &#123;(String)value&#125;);</span><br><span class="line">            &#125;else &#123;</span><br><span class="line">                params.put(name , new String[] &#123;String.valueOf(value)&#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /** 简单封装，请根据需求改进 */</span><br><span class="line">    public void addObject(Object obj) &#123;</span><br><span class="line">        Class&lt;?&gt; clazz = obj.getClass();</span><br><span class="line">        Method[] methods = clazz.getMethods();</span><br><span class="line">        try &#123;</span><br><span class="line">            for (Method method : methods) &#123;</span><br><span class="line">                if (!method.getName().startsWith(&quot;get&quot;)) &#123;</span><br><span class="line">                    continue;</span><br><span class="line">                &#125;</span><br><span class="line">                Object invoke = method.invoke(obj);</span><br><span class="line">                if (invoke == null || &quot;&quot;.equals(invoke)) &#123;</span><br><span class="line">                    continue;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                String filedName = method.getName().replace(&quot;get&quot;, &quot;&quot;);</span><br><span class="line">                filedName = WordUtils.uncapitalize(filedName);</span><br><span class="line"></span><br><span class="line">                if (invoke instanceof Collection) &#123;</span><br><span class="line">                    Collection collections = (Collection) invoke;</span><br><span class="line">                    if (collections != null &amp;&amp; collections.size() &gt; 0) &#123;</span><br><span class="line">                        String[] strings = (String[]) collections.toArray();</span><br><span class="line">                        addParameter(filedName, strings);</span><br><span class="line">                        return;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                addParameter(filedName, invoke);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; catch (IllegalAccessException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; catch (InvocationTargetException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="8-定义一个过滤器"><a href="#8-定义一个过滤器" class="headerlink" title="8. 定义一个过滤器"></a>8. 定义一个过滤器</h5><ul>
<li>在这个过滤里面，主要校验Token是否有效以及将会员信息添加到request。首先，从Request请求头中拿到前端传过来的Token，并使用Token调用会员信息获取接口，得到用户的资料，然后将用户信息put到ParameterMap中，这个ParameterMap是我们通过ParameterRequestWrapper重新包装的一个map，因此可以在里面添加会员的参数，然后将新的request传递出去。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">import com.fasterxml.jackson.databind.ObjectMapper;</span><br><span class="line">import org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line">import javax.servlet.*;</span><br><span class="line">import javax.servlet.annotation.WebFilter;</span><br><span class="line">import javax.servlet.http.HttpServletRequest;</span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.util.Date;</span><br><span class="line">import java.util.HashMap;</span><br><span class="line">import java.util.Map;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @Author: XiongFeng</span><br><span class="line"> * @Description: 会员登录信息过滤器</span><br><span class="line"> * @Date: Created in 11:17 2018/4/13</span><br><span class="line"> */</span><br><span class="line">@Component</span><br><span class="line">@WebFilter(urlPatterns = &quot;/*&quot;)</span><br><span class="line">public class MemberFilter implements Filter &#123;</span><br><span class="line"></span><br><span class="line">    MemberService memberService = new MemberServiceImpl();</span><br><span class="line"></span><br><span class="line">    ObjectMapper objectMapper = new ObjectMapper();</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void init(FilterConfig filterConfig) throws ServletException &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException &#123;</span><br><span class="line"></span><br><span class="line">        HttpServletRequest req = (HttpServletRequest) request;</span><br><span class="line"></span><br><span class="line">        String tokenId = req.getHeader(&quot;X-Authorization&quot;);</span><br><span class="line"></span><br><span class="line">        if (tokenId == null || &quot;&quot;.equals(tokenId) || tokenId.isEmpty()) &#123;</span><br><span class="line">            chain.doFilter(request, response);</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        MemberDetails memberDetails = memberService.getMemberDetailsByToken(tokenId);</span><br><span class="line">        if (memberDetails == null) this.respFail(response);</span><br><span class="line"></span><br><span class="line">        ParameterRequestWrapper requestWrapper = new ParameterRequestWrapper(req);</span><br><span class="line">        requestWrapper.addObject(memberDetails);</span><br><span class="line">        chain.doFilter(requestWrapper, response);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">	/** 返回失败结果Json数据 */</span><br><span class="line">    private void respFail(ServletResponse response) throws IOException &#123;</span><br><span class="line">        Map&lt;String, Object&gt; map = new HashMap&lt;&gt;();</span><br><span class="line">        map.put(&quot;status&quot;, 500);</span><br><span class="line">        map.put(&quot;message&quot;, &quot;登录失效，请登录&quot;);</span><br><span class="line">        map.put(&quot;data&quot;, null);</span><br><span class="line">        String s = objectMapper.writeValueAsString(map);</span><br><span class="line">        response.setCharacterEncoding(&quot;UTF-8&quot;);</span><br><span class="line">        response.setContentType(&quot;application/json; charset=utf-8&quot;);</span><br><span class="line">        response.getWriter().write(s);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void destroy() &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="9-定义一个SpringMVC拦截器"><a href="#9-定义一个SpringMVC拦截器" class="headerlink" title="9. 定义一个SpringMVC拦截器"></a>9. 定义一个SpringMVC拦截器</h5><ul>
<li>在这个拦截器里面，主要验证Controller方法中是否需要MemberDetails和是否标了@Login注解。首先，从HandlerMethod中获取所有入参，看有没有需要MemberDetails参数，如果有，就从HttpServletRequest中拿memberId，如果不存在说明没有登录，存在就通过。然后HandlerMethod获取@Login注解，判断是否存在，如果存在，就看有没有memberId,没有就不通过。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">package cn.seifon.paymodle.interceptor;</span><br><span class="line"></span><br><span class="line">import cn.seifon.paymodle.annotations.Login;</span><br><span class="line">import cn.seifon.paymodle.dto.MemberDetails;</span><br><span class="line">import cn.seifon.paymodle.service.manager.member.MemberService;</span><br><span class="line">import cn.seifon.paymodle.service.manager.member.impl.MemberServiceImpl;</span><br><span class="line">import com.fasterxml.jackson.databind.ObjectMapper;</span><br><span class="line">import org.springframework.core.MethodParameter;</span><br><span class="line">import org.springframework.web.method.HandlerMethod;</span><br><span class="line">import org.springframework.web.servlet.handler.HandlerInterceptorAdapter;</span><br><span class="line"></span><br><span class="line">import javax.servlet.http.HttpServletRequest;</span><br><span class="line">import javax.servlet.http.HttpServletResponse;</span><br><span class="line">import java.lang.reflect.Type;</span><br><span class="line">import java.util.HashMap;</span><br><span class="line">import java.util.Map;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @Author: XiongFeng</span><br><span class="line"> * @Description: 会员登录信息拦截器</span><br><span class="line"> * @Date: Created in 11:17 2018/4/13</span><br><span class="line"> */</span><br><span class="line">public class MemberInterceptor extends HandlerInterceptorAdapter &#123;</span><br><span class="line"></span><br><span class="line">    ObjectMapper objectMapper = new ObjectMapper();</span><br><span class="line"></span><br><span class="line">    MemberService memberService = new MemberServiceImpl();</span><br><span class="line"></span><br><span class="line">    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws IOException &#123;</span><br><span class="line"></span><br><span class="line">        HandlerMethod method = (HandlerMethod) handler;</span><br><span class="line">        String[] memberIds = request.getParameterValues(&quot;memberId&quot;);</span><br><span class="line"></span><br><span class="line">        MethodParameter[] methodParameters = method.getMethodParameters();</span><br><span class="line">        //判断方法类是否有MemberDetails入参</span><br><span class="line">        if (methodParameters.length &gt; 0) &#123;</span><br><span class="line">            for (MethodParameter methodParameter : methodParameters) &#123;</span><br><span class="line">                Type genericParameterType = methodParameter.getGenericParameterType();</span><br><span class="line">                String typeName = genericParameterType.getTypeName();</span><br><span class="line">                if (!typeName.equals(MemberDetails.class.getTypeName())) continue;</span><br><span class="line">                if (memberIds == null || memberIds.length &lt;= 0) return this.respFail(response); //如果找不到用户信息就返回失败</span><br><span class="line">                break;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        //判断是否有Login注解</span><br><span class="line">        Login login = method.getMethodAnnotation(Login.class);</span><br><span class="line">        if (login == null) return true;</span><br><span class="line"></span><br><span class="line">        if (memberIds == null || memberIds.length &lt;= 0) return this.respFail(response); //如果找不到用户信息就返回失败</span><br><span class="line">        return true;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	/** 返回失败结果Json数据 */</span><br><span class="line">    private boolean respFail(HttpServletResponse response) throws IOException &#123;</span><br><span class="line">        Map&lt;String, Object&gt; map = new HashMap&lt;&gt;();</span><br><span class="line">        map.put(&quot;status&quot;, 500);</span><br><span class="line">        map.put(&quot;message&quot;, &quot;登录失效，请登录&quot;);</span><br><span class="line">        map.put(&quot;data&quot;, null);</span><br><span class="line">        String s = objectMapper.writeValueAsString(map);</span><br><span class="line">        response.setCharacterEncoding(&quot;UTF-8&quot;);</span><br><span class="line">        response.setContentType(&quot;application/json; charset=utf-8&quot;);</span><br><span class="line">        response.getWriter().write(s);</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="10-将拦截器注册到WebMvcConfigurer中"><a href="#10-将拦截器注册到WebMvcConfigurer中" class="headerlink" title="10. 将拦截器注册到WebMvcConfigurer中"></a>10. 将拦截器注册到WebMvcConfigurer中</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">@Configuration</span><br><span class="line">public class MyWebAppConfigurer</span><br><span class="line">        extends WebMvcConfigurerAdapter &#123;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void addInterceptors(InterceptorRegistry registry) &#123;</span><br><span class="line">        // addPathPatterns 用于添加拦截规则</span><br><span class="line">        registry.addInterceptor(new MemberInterceptor()).addPathPatterns(&quot;/**&quot;);</span><br><span class="line">        super.addInterceptors(registry);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="11-定义会员Controller"><a href="#11-定义会员Controller" class="headerlink" title="11. 定义会员Controller"></a>11. 定义会员Controller</h5><ul>
<li>经过一个过滤器和一个拦截器，request请求终于来到了我们Controller层。这时候，我们只需要在方法里面写入MemberDetails memberDetails 就OK了，不用做任何操作，我们就可以获取会员信息了，是不是炒鸡方便！另外还可以在方法上标@Login注解。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">@RestController</span><br><span class="line">public class MemberController &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	@RequestMapping(&quot;/token&quot;)</span><br><span class="line">    @Login</span><br><span class="line">    public Map&lt;String, Object&gt; getUser(MemberDetails memberDetails) &#123;</span><br><span class="line">        //User user = userManager.selectByPrimaryKey(id);</span><br><span class="line">        Map&lt;String, Object&gt; map = new LinkedHashMap&lt;&gt;();</span><br><span class="line">        map.put(&quot;status&quot;, 200);</span><br><span class="line">        map.put(&quot;message&quot;, &quot;请求成功&quot;);</span><br><span class="line">        map.put(&quot;data&quot;, memberDetails);</span><br><span class="line">        return map;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<p><img src="//ww1.sinaimg.cn/large/005zWjpngy1fqkm3hli7hj30u60a0abm.jpg" alt="img"></p>
<p><img src="//ww1.sinaimg.cn/large/005zWjpngy1fqkm5g7xp3j30u10cr76b.jpg" alt="img"></p>
<h4 id="遇到的坑："><a href="#遇到的坑：" class="headerlink" title="遇到的坑："></a>遇到的坑：</h4><ul>
<li><p>当时我尝试过把会员参数放到session域中的Attribute，也尝试过在Model里setAttribute。后来发现这是行不通的，在filter中直接使用request.setAttribute()是无效的。放在Modle也是可行，但是Controller里面的方法需要加@ModelAttribute(“…”)才能得到用户信息，很不方便。唯有通过request.getParameterMap() put()进去，才是最方便的。</p>
</li>
<li><p>一开始我没想到用过滤器，因此我就尝试在拦截器里，直接通过ParameterRequestWrapper对request包装，后来发现不管我怎么弄都不成功。当时非常绝望，后来想了想会不会是拦截器不支持重新包装request，于是我就通过filter去做，没想到成功了。这时，我想既然用到了filter，那干脆直接在filter里面获取@Login注解和获取方法参数得了，后来发现filter里面拿不到方法的信息，哭。后来想到一个办法，可以通过先filter，后拦截器。于是就成功了！</p>
</li>
</ul>
<h4 id="后记："><a href="#后记：" class="headerlink" title="后记："></a>后记：</h4><ul>
<li>这篇文章只是记录了我的一点小小经验，如果有什么不对的地方或者有更好的方法，请大家在评论里留言指正！</li>
</ul>
<p>参考文章：<a href="http://www.importnew.com/19023.html" target="_blank" rel="noopener">http://www.importnew.com/19023.html</a></p>

    </div>

    <div class="post-footer">
        <div class="col-sm-10">
            <div>
                <b>本文链接</b>：<a href="/2018/04/21/利用Filter和拦截器，将用户信息动态传入Request方法/">利用Filter和Spring拦截器，将用户信息动态传入Request方法</a>
            </div>
            <div>
                
                    转载声明：本博客由熊峰创作，采用 <a href="https://creativecommons.org/licenses/by-nc-nd/3.0/" target="_blank"> CC BY 3.0 CN </a> 许可协议。可自由转载、引用，但需署名作者且注明文章出处。如转载至微信公众号，请在文末添加作者公众号二维码。
                
            </div>
            <div>
                
            </div>
        </div>
        <div class="col-sm-2">
            <img src="http://ww1.sinaimg.cn/large/005zWjpngy1fqpaewa9faj307607674q.jpg" width=100% />
        </div>
    </div>
</article>

<div class="article-nav prev-next-wrap clearfix">
    
        <a href="/2018/04/30/Spring统一返回Json工具类，带分页信息/" class="pre-post btn btn-default" title='Spring统一返回Json工具类，带分页信息'>
            <i class="fa fa-angle-left fa-fw"></i><span class="hidden-lg">上一篇</span>
            <span class="hidden-xs">Spring统一返回Json工具类，带分页信息</span>
        </a>
    
    
        <a href="/2017/09/05/Nginx的五种负载算法模式/" class="next-post btn btn-default" title='Nginx的五种负载算法模式'>
            <span class="hidden-lg">下一篇</span>
            <span class="hidden-xs">Nginx的五种负载算法模式</span><i class="fa fa-angle-right fa-fw"></i>
        </a>
    
</div>


    <div id="comments">
        
	<!--PC和WAP自适应版-->
<div id="SOHUCS"></div>
<script type="text/javascript">
	(function(){var appid='cytEo3Kuu';var conf='prod_f87ce311d1eb4334ea957f57640e9d15';var width=window.innerWidth||document.documentElement.clientWidth;if(width<960){window.document.write('<script id="changyan_mobile_js" charset="utf-8" type="text/javascript" src="https://changyan.sohu.com/upload/mobile/wap-js/changyan_mobile.js?client_id='+appid+'&conf='+conf+'"><\/script>');}else{var loadJs=function(d,a){var c=document.getElementsByTagName("head")[0]||document.head||document.documentElement;var b=document.createElement("script");b.setAttribute("type","text/javascript");b.setAttribute("charset","UTF-8");b.setAttribute("src",d);if(typeof a==="function"){if(window.attachEvent){b.onreadystatechange=function(){var e=b.readyState;if(e==="loaded"||e==="complete"){b.onreadystatechange=null;a()}}}else{b.onload=a}}
	c.appendChild(b)};loadJs("https://changyan.sohu.com/upload/changyan.js",function(){window.changyan.api.config({appid:appid,conf:conf})});}})();
</script>	

    </div>





                </main>
                
    <aside class="col-md-4 sidebar">
        
        
    <div class="widget">    
        <h3 class="title">搜索</h3>
        <div id="search-form">
            <div id="result-mask" class="hide"></div>
            <div class="search-area">
                
                    <input id="search-key" type="search" autocomplete="off" placeholder="搜点什么呢?">
                    <button type="button" class="search-form-submit" id="search-local">站内搜索</button>
                
                
            </div>
            <div id="result-wrap" class="hide">
                <div id="search-result"></div>
            </div>
            <div class="hide">
                <template id="search-tpl">
                    <div class="item">
                        <a href="/{path}" title="{title}">
                            <div class="title">{title}</div>
                            <div class="content">{content}</div>
                        </a>
                    </div>
                </template>
            </div>
        </div>
    </div>

        
        
    <div class="widget notification">
        <h3 class="title">网站公告</h3>
        <div>
            <p>
  <b>笔者微信</b>：熊峰的博客，欢迎加我<br/>
  <b>公众号</b>：请扫描我的头像<br/>
</p>
        </div>
    </div>

        
        
        <div class="widget">
            <div class="about-me">
                <img src="http://ww1.sinaimg.cn/large/005zWjpngy1fqpaewa9faj307607674q.jpg" alt="熊峰的博客 - Seifon's Blog">
                <h2>熊峰-Seifon</h2>
                <p>不定期为大家分享开发当中的小经验</p>
            </div>
        </div>




        
        
    <div class="widget">
      <h3 class="title">社交</h3> 
        <div class="content social">
            
	            <a href="//github.com/seifon" rel="external nofollow" title="GitHub" target="_blank">
			    	<i class="github fa fa-github"></i>
			    </a>
            
	            <a href="//gitee.com/seifon" rel="external nofollow" title="Git@OSC" target="_blank">
			    	<i class="git fa fa-git"></i>
			    </a>
            
	            <a href="mailto:seifon@126.com" rel="external nofollow" title="邮箱" target="_blank">
			    	<i class="envelope-o fa fa-envelope-o"></i>
			    </a>
            
	            <a href="/atom.xml" rel="external nofollow" title="RSS" target="_blank">
			    	<i class="feed fa fa-feed"></i>
			    </a>
            
        </div>
    </div>


        
        
    <div class="widget">
        <h3 class="title">分类</h3>
        <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Iptables/"><i class="fa" aria-hidden="true">Iptables</i></a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/JAVA调优/"><i class="fa" aria-hidden="true">JAVA调优</i></a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Jenkins/"><i class="fa" aria-hidden="true">Jenkins</i></a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Mysql/"><i class="fa" aria-hidden="true">Mysql</i></a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Nginx/"><i class="fa" aria-hidden="true">Nginx</i></a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Restful/"><i class="fa" aria-hidden="true">Restful</i></a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Spring/"><i class="fa" aria-hidden="true">Spring</i></a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Yaml/"><i class="fa" aria-hidden="true">Yaml</i></a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/算法/"><i class="fa" aria-hidden="true">算法</i></a><span class="category-list-count">1</span></li></ul>
    </div>


        
        
    <div class="widget">
      <h3 class="title">归档</h3>
        <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/"><i class="fa" aria-hidden="true">四月 2018</i></a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/"><i class="fa" aria-hidden="true">九月 2017</i></a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/"><i class="fa" aria-hidden="true">七月 2017</i></a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/"><i class="fa" aria-hidden="true">六月 2017</i></a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/"><i class="fa" aria-hidden="true">五月 2017</i></a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/"><i class="fa" aria-hidden="true">四月 2017</i></a><span class="archive-list-count">1</span></li></ul>
    </div>


        
        
  <div class="widget">
    <h3 class="title">标签云</h3>
    <div class="content tag-cloud">
        <a href="/tags/CI/" style="font-size: 10px;">CI</a> <a href="/tags/Filter/" style="font-size: 10px;">Filter</a> <a href="/tags/Jenkins/" style="font-size: 10px;">Jenkins</a> <a href="/tags/Json/" style="font-size: 10px;">Json</a> <a href="/tags/Jstack/" style="font-size: 10px;">Jstack</a> <a href="/tags/Mysql/" style="font-size: 10px;">Mysql</a> <a href="/tags/Nginx/" style="font-size: 10px;">Nginx</a> <a href="/tags/Rest/" style="font-size: 10px;">Rest</a> <a href="/tags/Util/" style="font-size: 10px;">Util</a> <a href="/tags/Yaml/" style="font-size: 10px;">Yaml</a> <a href="/tags/centos/" style="font-size: 20px;">centos</a> <a href="/tags/iptables/" style="font-size: 20px;">iptables</a> <a href="/tags/linux/" style="font-size: 20px;">linux</a> <a href="/tags/yml/" style="font-size: 10px;">yml</a> <a href="/tags/备份/" style="font-size: 10px;">备份</a> <a href="/tags/定时/" style="font-size: 10px;">定时</a> <a href="/tags/容灾/" style="font-size: 10px;">容灾</a> <a href="/tags/拦截器/" style="font-size: 10px;">拦截器</a> <a href="/tags/数据库/" style="font-size: 10px;">数据库</a> <a href="/tags/数据结构/" style="font-size: 10px;">数据结构</a> <a href="/tags/栈/" style="font-size: 10px;">栈</a> <a href="/tags/算法/" style="font-size: 10px;">算法</a> <a href="/tags/调优/" style="font-size: 10px;">调优</a> <a href="/tags/负载均衡/" style="font-size: 10px;">负载均衡</a> <a href="/tags/防火墙/" style="font-size: 20px;">防火墙</a> <a href="/tags/面试/" style="font-size: 10px;">面试</a>
    </div>
  </div>


        
        
    <div class="widget">
        <h3 class="title">友链</h3>
        <div class="content friends-link">
        
            <a href="https://www.seifon.cn/" class="fa" target="_blank">熊峰的博客</a>
        
        </div>
    </div>


        
    </aside>

            </div>
        </div>
    </section>
    <footer class="main-footer">
    <div class="container">
        <div class="row">
        </div>
    </div>
</footer>

<a id="back-to-top" class="hide">
	<i class="fa fa-chevron-up"></i>
</a>




    <div class="copyright">
    <div class="container">
        <div class="row">
            <div class="col-sm-12"> 
                <span>Copyright &copy; 2017
                </span> | 
                <span>
                    Powered by <a href="//hexo.io" class="copyright-links" target="_blank" rel="nofollow">Hexo</a>
                </span> | 
                <span>
                    Theme by <a href="//github.com/itmuch/hexo-theme-itmuch.git" class="copyright-links" target="_blank" rel="nofollow">ITMuch</a>
                </span>
            </div>
        </div>
    </div>
</div>



	<script src="/js/search.js?rev=@@hash"></script>


<script src="/js/app.js?rev=@@hash"></script>


</body>
</html>